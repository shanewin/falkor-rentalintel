<!DOCTYPE html>
<html>
<head>
    <title>Embedding Search</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        form { margin-bottom: 20px; }
        textarea { width: 100%; height: 80px; }
        .error { color: #b00; margin-top: 10px; }
        .result { border: 1px solid #ddd; padding: 10px; margin-bottom: 10px; }
        .meta { color: #555; font-size: 0.9em; }
    </style>
    {% csrf_token %}
</head>
<body>
    <h1>Embedding Search</h1>

    <form method="post">
        {% csrf_token %}
        <label for="query">Query</label><br />
        <textarea name="query" id="query" required>{{ query }}</textarea><br />
        <label for="k">Top K (1-20)</label>
        <input type="number" name="k" id="k" value="{{ k }}" min="1" max="20" />
        <button type="submit">Search</button>
    </form>

    {% if error %}
        <div class="error">{{ error }}</div>
    {% endif %}

    {% if results %}
        <h2>Results ({{ results|length }})</h2>
        {% for r in results %}
            <div class="result">
                <div class="meta"><strong>{{ r.file_name }}</strong> â€” similarity: {{ r.similarity|floatformat:3 }}</div>
                <pre style="white-space: pre-wrap;">{{ r.content }}</pre>
            </div>
        {% endfor %}
    {% endif %}
</body>
</html>
