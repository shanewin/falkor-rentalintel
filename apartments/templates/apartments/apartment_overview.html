{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/apartments.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <div></div> <!-- Placeholder for spacing -->
        <div>
            <a href="{% url 'create_application' apartment.id %}" class="btn btn-primary me-2">
                <i class="fas fa-plus"></i> Create Application
            </a>
            <a href="{% url 'apartment_detail' apartment.id %}" class="btn btn-outline-secondary">
                <i class="fas fa-edit"></i> Update Apartment
            </a>
        </div>
    </div>

    <!-- Hero Section -->
    <div class="hero-section mb-4 text-center">
        <h1 class="display-4">Unit {{ apartment.unit_number }}</h1>
        <p class="lead">{{ apartment.building.name }} â€“ {{ apartment.building.street_address_1 }}, {{ apartment.building.city }}</p>
    </div>

    <!-- Image Carousel -->
    {% if apartment.images.all %}
        <div id="apartmentCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
            <div class="carousel-inner">
                {% for image in apartment.images.all %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <img src="{{ image.large_url }}" class="d-block w-100 carousel-img" alt="Apartment Image">
                    </div>
                {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#apartmentCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#apartmentCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    {% else %}
        <p class="text-warning mb-5">No images uploaded for this apartment.</p>
    {% endif %}

    <!-- Apartment Details -->
    <div class="row mt-5">
        <div class="col-md-8">
            <h3>Apartment Details</h3>
            <div class="row">
                {% for field, value in apartment.get_filled_fields.items %}
                    {% if field != "Description" and field != "Required Documents" %}
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h5 class="card-title">{{ field }}</h5>
                                    <p class="card-text">{{ value|safe }}</p>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>

        <!-- Amenities Section -->
        <div class="col-md-4">
            <h3>Amenities</h3>
            <div class="row">
                {% for amenity in apartment.amenities.all %}
                    <div class="col-md-12 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex align-items-center">
                                <div class="me-2">
                                    <i class="fas fa-check-circle"></i> <!-- Placeholder Icon -->
                                </div>
                                <div>{{ amenity.name }}</div>
                            </div>
                        </div>
                    </div>
                {% empty %}
                    <p>No amenities listed.</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Description Section -->
    {% if apartment.description %}
    <div class="description-section">
        <h3 class="section-title">Description</h3>
        <div class="description-content bg-light p-4 rounded">
            <p class="card-text">{{ apartment.description|safe }}</p>
        </div>
    </div>
    {% endif %}

    <!-- Required Documents Section -->
    {% if apartment.required_documents %}
    <div class="description-section mt-4">
        <h3 class="section-title">Required Documents</h3>
        <div class="description-content bg-light p-4 rounded">
            <p class="card-text">{{ apartment.required_documents|safe }}</p>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
